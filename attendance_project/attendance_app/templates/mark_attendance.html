{% extends 'base.html' %}
{% block title %}Mark Attendance{% endblock %}

{% block content %}
<h2>Mark Attendance</h2>

{% if messages %}
    {% for message in messages %}
        <p style="color: green;">{{ message }}</p>
    {% endfor %}
{% endif %}

<form method="POST">
    {% csrf_token %}
    <label>Select Date: </label>
    <input type="date" name="date" value="{{ today }}"><br><br>

    <table style="width: 100%; background: white; border-collapse: collapse;">
        <tr>
            <th style="padding: 10px; border: 1px solid #ccc;">Roll No</th>
            <th style="padding: 10px; border: 1px solid #ccc;">Name</th>
            <th style="padding: 10px; border: 1px solid #ccc;">Status</th>
        </tr>
        {% for student in students %}
        <tr>
            <td>{{ student.roll_number }}</td>
            <td>{{ student.name }}</td>
            <td>
                <select name="status_{{ student.id }}">
                    <option value="Present">Present</option>
                    <option value="Absent">Absent</option>
                </select>
            </td>
        </tr>
        {% endfor %}
    </table>

    <button type="submit" style="margin-top: 20px; padding: 10px 20px;">Submit</button>
</form>
<br>
 <a href="{% url 'dashboard' %}" class="button">Back to Dashboard</a>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector("form");
    const dateInput = document.querySelector('input[name="date"]');

    form.addEventListener("submit", function (e) {
        if (!dateInput.value) {
            alert("Please select a date before submitting attendance.");
            e.preventDefault(); // Stop form submission
        }
    });
});
</script>
{% endblock %}
